<html>
<head>
    <meta charset="UTF-8"/>
    <script src="assets/js/Winwheel.min.js"></script>
    <script src="assets/js/TweenMax.min.js"></script>
    <script type="text/javascript" src="assets/js/jquery-3.3.1.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Ruleta</title>
</head>
<body>
<div align="center">
    <input id="btn" type="button" value="Girar" onclick="firstWheel.startAnimation();"/>
</div>
<br/>
<br/>
<div align="center">
    <canvas id='canvas' height="400" width="400"></canvas>
</div>

</body>
<script>

    $('#btn').click(function(){
        $("#btn").prop( "disabled", true );
    });

    var firstWheel = new Winwheel({
        'canvasId'     : 'canvas',
        'drawMode'     : 'image',    // drawMode must be set to image.
        'outerRadius': 170,
        'numSegments'  : 6,          // The number of segments must be specified.
        'imageOverlay' : true,       // Set imageOverlay to true to display the overlay.
        'lineWidth'    : 4,          // Overlay uses wheel line width and stroke style so can set these
        'strokeStyle'  : 'red',       // as desired to change appearance of the overlay.
        'segments':[
            {'text': 'iPhoneX' },
            {'text': 'Lo siento' },
            {'text': 'iPhoneX' },
            {'text': 'Lo siento' },
            {'text': 'iPhoneX' },
            {'text': 'lo siento' }
        ],
        'animation': {
            'type': 'spinToStop',
            'duration': 5,
            'callbackFinished': 'Message()',
            'callbackAfter': 'indicator()'
        }
    });


    function Message() {

        var SegmentoSeleccionado = firstWheel.getIndicatedSegment();
        alert("Tu premio es un: " + SegmentoSeleccionado.text + "!");
        firstWheel.stopAnimation(false);
        firstWheel.rotationAngle = 0;
        firstWheel.draw();
        indicator();
    }

    // Create new image object in memory.
    var firstImg = new Image();

    // Create callback to execute once the image has finished loading.
    firstImg.onload = function()
    {
        firstWheel.wheelImage = firstImg;    // Make wheelImage equal the loaded image object.
        // Set the image source, once complete this will trigger the onLoad callback (above).
        firstWheel.draw(); // Also call draw function to render the wheel.
        indicator();
    };

    firstImg.src = "assets/img/wheel_image.png";


    var ctx = firstWheel.ctx;

    function indicator() {
        ctx.save();
        ctx.strokeStyle = 'navy';
        ctx.fillStyle = 'black';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(170, 0);
        ctx.lineTo(230, 0);
        ctx.lineTo(200, 40);
        ctx.lineTo(171, 0);
        ctx.stroke();
        ctx.fill();
        ctx.restore();

//        alert("indicator");
    }




</script>
</html>
